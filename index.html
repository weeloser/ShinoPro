<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ШинаДом - Профессиональный Шиномонтаж</title>
    <link rel="icon" href="https://i.postimg.cc/C1hpVcxb/image.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/gh/studio-freight/lenis@1.0.19/bundled/lenis.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #030712; 
            color: #f9fafb;
            background-image: linear-gradient(to bottom right, #030712, #111827, #030712);
            overflow-x: hidden;
        }
        .hero-parallax {
            background-image: url('https://i.postimg.cc/W4QNn4y3/image-1.webp');
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
            background-attachment: fixed;
        }
        .text-shadow {
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        [data-aos] {
            transition-property: transform, opacity;
        }
        
        @keyframes pulse-slow {
          50% {
            transform: scale(1.03);
            box-shadow: 0 0 15px rgba(34, 211, 238, 0.4); 
          }
        }
        .animate-pulse-slow {
            animation: pulse-slow 2.5s infinite ease-in-out;
        }

        @keyframes pulse-cta {
          50% {
            transform: scale(1.04);
          }
        }
        .animate-pulse-cta {
            animation: pulse-cta 2s infinite ease-in-out;
        }

        .custom-select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%2322d3ee' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' class='lucide lucide-chevron-down'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1.5em 1.5em;
        }
        
        .service-icon {
            transition: transform 0.3s ease;
        }
        .service-card:hover .service-icon {
            transform: translateY(-4px) scale(1.05);
        }
        
        @keyframes shimmering-glow {
          0% { 
            box-shadow: 0 0 10px rgba(34, 211, 238, 0.2);
            border-color: rgba(55, 65, 81, 0.5);
          }
          50% { 
            box-shadow: 0 0 25px rgba(34, 211, 238, 0.6);
            border-color: rgba(34, 211, 238, 0.8);
          }
          100% { 
            box-shadow: 0 0 10px rgba(34, 211, 238, 0.2);
            border-color: rgba(55, 65, 81, 0.5);
          }
        }
        
        .service-card {
            transition: transform 0.3s ease;
        }
        
        .service-card:hover {
            transform: translateY(-8px);
            animation: shimmering-glow 2.5s infinite ease-in-out;
        }

        @keyframes shimmering-glow-price {
          0% { 
            box-shadow: 0 0 10px rgba(34, 211, 238, 0.2);
            border-color: rgba(55, 65, 81, 0.5);
          }
          50% { 
            box-shadow: 0 0 25px rgba(34, 211, 238, 0.6);
            border-color: rgba(34, 211, 238, 0.7);
          }
          100% { 
            box-shadow: 0 0 10px rgba(34, 211, 238, 0.2);
            border-color: rgba(55, 65, 81, 0.5);
          }
        }
        
        .price-glow-card {
            transition: transform 0.3s ease;
        }
        
        .price-glow-card:hover {
            animation: shimmering-glow-price 2.5s infinite ease-in-out;
            transform: translateY(-4px);
        }

        @keyframes pulse-glow-btn {
          0%, 100% {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(34, 211, 238, 0.5);
          }
          50% {
            transform: scale(1.1);
            box-shadow: 0 0 25px rgba(34, 211, 238, 0.8);
          }
        }
        
        .animate-pulse-glow-btn {
            animation: pulse-glow-btn 2s infinite ease-in-out;
            transform: scale(1.05);
        }

        .price-list-item {
            transition: background-color 0.2s ease, transform 0.2s ease;
        }
        .price-list-item:hover {
            background-color: #1f2937;
            transform: translateX(5px);
        }

        .svg-anim-part {
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .glass-header {
            background-color: rgba(3, 7, 18, 0.6); 
            backdrop-filter: blur(16px);
            border-bottom: 1px solid rgba(55, 65, 81, 0.5); 
        }

        .glass-card {
            background-color: rgba(17, 24, 39, 0.6); 
            backdrop-filter: blur(12px);
            border: 1px solid rgba(55, 65, 81, 0.5); 
            transition: all 0.3s ease;
        }
        .glass-card:hover {
            background-color: rgba(31, 41, 55, 0.7); 
        }
        
        .glass-modal {
             background-color: rgba(31, 41, 55, 0.9); 
            backdrop-filter: blur(12px);
            border: 1px solid rgba(75, 85, 99, 0.5); 
        }
        
        .glass-button {
            background-color: rgba(17, 24, 39, 0.6); 
            backdrop-filter: blur(8px);
            border-color: rgba(55, 65, 81, 0.5); 
            transition: all 0.2s ease;
        }
        .glass-button:hover {
            background-color: rgba(31, 41, 55, 0.7); 
            border-color: #22d3ee;
        }
        .glass-button.selected {
            background-color: #22d3ee;
            color: #111827;
            font-weight: bold;
            border-color: #22d3ee;
            backdrop-filter: none;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .spinning-group {
            animation: spin 5s linear infinite;
        }
        
        @keyframes pop {
          0% { transform: scale(1); }
          50% { transform: scale(1.05); }
          100% { transform: scale(1); }
        }
        .animate-pop {
            animation: pop 0.3s ease-out;
        }
        
        @keyframes shake {
          0%, 100% { transform: translateX(0); }
          10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
          20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        .input-error {
            border-color: #ef4444 !important;
            box-shadow: 0 0 10px rgba(239, 68, 68, 0.4);
            animation: shake 0.5s ease-in-out;
        }

        .btn-disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: scale(1) !important;
            background-color: #4b5563 !important;
            hover:background-color: #4b5563 !important;
        }

        #calc-individual-services label {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s ease;
        }
        #calc-individual-services label:hover {
            background-color: rgba(55, 65, 81, 0.7);
        }
        #calc-individual-services input[type="checkbox"] {
            transform: scale(1.2);
            flex-shrink: 0;
        }
        #calc-individual-services .service-label-text {
            margin-left: 0.75rem;
            display: block;
            flex-grow: 1;
        }

        .bg-gray-900 { background-color: #111827; }
        .bg-gray-800 { background-color: #1f2937; }
        .text-cyan-400 { color: #22d3ee; }
        .hover\:text-cyan-400:hover { color: #22d3ee; }
        .bg-cyan-400 { background-color: #22d3ee; }
        .hover\:bg-cyan-300:hover { background-color: #67e8f9; }
        .hover\:shadow-cyan-400\/30:hover { --tw-shadow-color: rgba(34, 211, 238, 0.3); --tw-shadow: var(--tw-shadow-colored); }
        .border-cyan-400 { border-color: #22d3ee; }
        .focus\:border-cyan-400:focus { border-color: #22d3ee; }
        .focus\:ring-cyan-400:focus { --tw-ring-color: #22d3ee; }
        .text-cyan-300 { color: #67e8f9; }
        .hover\:text-cyan-300:hover { color: #67e8f9; }
        .text-green-400 { color: #4ade80; }
    </style>
</head>
<body class="bg-gray-900 text-white">

    <header class="fixed top-0 left-0 right-0 z-50 glass-header" data-aos="fade-down">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" class="text-3xl font-black text-cyan-400 transition-transform transform hover:scale-110 hover:drop-shadow-[0_0_10px_#22d3ee]">ШИНАДОМ</a>
            <div class="hidden md:flex space-x-6 items-center">
                <a href="#services" class="hover:text-cyan-400 transition duration-300 transform hover:scale-110 inline-block">Услуги</a>
                <a href="#pricing" class="hover:text-cyan-400 transition duration-300 transform hover:scale-110 inline-block">Цены</a>
                <a href="#contact" class="hover:text-cyan-400 transition duration-300 transform hover:scale-110 inline-block">Контакты</a>
                <a href="#contact" class="bg-cyan-400 text-gray-900 font-bold py-2 px-5 rounded-lg shadow-md hover:bg-cyan-300 transition duration-300 transform hover:scale-105">
                    Записаться
                </a>
            </div>
            <div class="md:hidden">
                <a href="#contact" class="bg-cyan-400 text-gray-900 font-bold py-2 px-4 rounded-lg shadow-md hover:bg-cyan-300 transition duration-300">
                    Связь
                </a>
            </div>
        </nav>
        <div id="scroll-progress-bar" class="fixed top-[65px] left-0 z-50 h-1 bg-cyan-400 shadow-[0_0_10px_#22d3ee]" style="width: 0%;"></div>
    </header>

    <main>
        <section id="hero" class="hero-parallax h-screen flex items-center justify-center text-center relative">
            <div class="absolute inset-0 bg-black opacity-60"></div>
            <div class="relative z-10 px-4" data-aos="fade-up">
                <h1 class="text-6xl md:text-8xl lg:text-9xl font-black uppercase text-shadow">ШИНАДОМ</h1>
                <p class="text-xl md:text-3xl font-light mt-4 mb-10 text-gray-200 text-shadow">Переобуем всех! Быстро. Четко. Без очередей.</p>
                <div class="flex flex-col sm:flex-row justify-center gap-4" data-aos="fade-up" data-aos-delay="300">
                    <a href="https://wa.me/79027513964" target="_blank" class="bg-green-500 text-white font-bold py-4 px-8 rounded-lg shadow-xl hover:bg-green-400 transition duration-300 transform hover:scale-105 flex items-center justify-center gap-2 animate-pulse-slow">
                        <i data-lucide="smartphone"></i>
                        Написать в WhatsApp
                    </a>
                    <a href="https://t.me/+79027513964" target="_blank" class="bg-blue-500 text-white font-bold py-4 px-8 rounded-lg shadow-xl hover:bg-blue-400 transition duration-300 transform hover:scale-105 flex items-center justify-center gap-2 animate-pulse-slow">
                        <i data-lucide="send"></i>
                        Написать в Telegram
                    </a>
                    <a href="tel:+79029093879" class="bg-cyan-400 text-gray-900 font-bold py-4 px-8 rounded-lg shadow-xl hover:bg-cyan-300 transition duration-300 transform hover:scale-105 flex items-center justify-center gap-2 animate-pulse-slow">
                        <i data-lucide="phone-call"></i>
                        Позвонить
                    </a>
                </div>
            </div>
            <div class="absolute bottom-10 z-10" data-aos="fade-up" data-aos-delay="500">
                <i data-lucide="arrow-down" class="animate-bounce h-10 w-10"></i>
            </div>
        </section>

        <section id="services" class="py-20 bg-gray-800">
            <div class="container mx-auto px-6">
                <h2 class="text-4xl font-bold text-center mb-12" data-aos="fade-up">Наши Услуги</h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="glass-card p-8 rounded-xl shadow-2xl transition-all duration-300 service-card flex flex-col" data-aos="fade-up" data-aos-delay="100">
                        <div class="text-cyan-400 mb-4 service-icon">
                            <i data-lucide="replace" class="h-12 w-12"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-3">Сезонная "переобувка"</h3>
                        <p class="text-gray-400">Полный комплекс: снятие, мойка, демонтаж, монтаж, балансировка и установка.</p>
                    </div>
                    <div class="glass-card p-8 rounded-xl shadow-2xl transition-all duration-300 service-card flex flex-col" data-aos="fade-up" data-aos-delay="200">
                        <div class="text-cyan-400 mb-4 service-icon">
                            <i data-lucide="wrench" class="h-12 w-12"></i> 
                        </div>
                        <h3 class="text-2xl font-bold mb-3">Ремонт проколов и порезов</h3>
                        <p class="text-gray-400">Ремонтируем боковые порезы и проколы любой сложности. Быстро и надежно.</p>
                    </div>
                    <div class="glass-card p-8 rounded-xl shadow-2xl transition-all duration-300 service-card flex flex-col" data-aos="fade-up" data-aos-delay="300">
                        <div class="text-cyan-400 mb-4 service-icon">
                            <i data-lucide="circle-dashed" class="h-12 w-12"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-3">Балансировка</h3>
                        <p class="text-gray-400">Точная балансировка на современном оборудовании. Устраняем биение руля.</p>
                    </div>
                </div>
            </div>
        </section>

        <div id="why-us-container" class="h-[300vh] relative">
            <section id="why-us" class="py-20 bg-gray-900 sticky top-0 h-screen flex items-center">
                <div class="container mx-auto px-6 text-center">
                    <h2 class="text-4xl font-bold mb-12 pt-16" data-aos="fade-in">Наш подход</h2>
                    <div class="max-w-4xl mx-auto grid md:grid-cols-2 gap-12 items-center text-left">
                        <div class="mt-8 md:mt-0">
                            <div class="flex items-center gap-4 mb-3 transition-transform duration-300 transform hover:scale-105" data-aos="fade-right" data-aos-delay="100">
                                <i data-lucide="clock" class="h-8 w-8 text-cyan-400"></i>
                                <h3 class="text-2xl font-bold">Работаем быстро</h3>
                            </div>
                            <p class="text-gray-300" data-aos="fade-right" data-aos-delay="200">Ваше время — наш приоритет. Забудьте об очередях. Мы ценим каждую вашу минуту и работаем на результат.</p>
                        </div>
                        <div id="wheel-container" class="w-full h-full min-h-[300px] max-w-[70%] mx-auto">
                            <svg id="wheel" viewBox="-100 -100 200 200" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="w-full h-full">
                                <defs>
                                    <radialGradient id="tireGradient" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                                        <stop offset="0%" style="stop-color:#383838; stop-opacity:1" />
                                        <stop offset="50%" style="stop-color:#1c1c1c; stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#000000; stop-opacity:1" />
                                    </radialGradient>
                                    <pattern id="treadPattern" patternUnits="userSpaceOnUse" width="10" height="10" x="0" y="0">
                                        <rect width="6" height="10" fill="#030303" opacity="0.6"/>
                                    </pattern>
                                    <linearGradient id="rimMainGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                        <stop offset="0%" style="stop-color:#67e8f9; stop-opacity:1" />
                                        <stop offset="50%" style="stop-color:#22d3ee; stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#0e7490; stop-opacity:1" />
                                    </linearGradient>
                                    <linearGradient id="rimDarkGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                        <stop offset="0%" style="stop-color:#374151; stop-opacity:1" />
                                        <stop offset="50%" style="stop-color:#1f2937; stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#111827; stop-opacity:1" />
                                    </linearGradient>
                                    <linearGradient id="spokeGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                        <stop offset="0%" style="stop-color:#1f2937; stop-opacity:1" />
                                        <stop offset="40%" style="stop-color:#22d3ee; stop-opacity:1" />
                                        <stop offset="60%" style="stop-color:#22d3ee; stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#1f2937; stop-opacity:1" />
                                    </linearGradient>
                                    <radialGradient id="hubGradient" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                                        <stop offset="0%" style="stop-color:#67e8f9; stop-opacity:1" />
                                        <stop offset="50%" style="stop-color:#22d3ee; stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#111827; stop-opacity:1" />
                                    </radialGradient>
                                    <filter id="deepShadow">
                                        <feDropShadow dx="3" dy="3" stdDeviation="4" flood-color="#000" flood-opacity="0.5"/>
                                    </filter>
                                    <filter id="softInnerShadow">
                                        <feOffset dx="0" dy="0"/>
                                        <feGaussianBlur stdDeviation="4" result="offset-blur"/>
                                        <feComposite operator="out" in="SourceGraphic" in2="offset-blur" result="inverse-mask"/>
                                        <feFlood flood-color="#000" flood-opacity="0.4" result="color"/>
                                        <feComposite operator="in" in="color" in2="inverse-mask" result="shadow"/>
                                        <feComposite operator="over" in="shadow" in2="SourceGraphic"/>
                                    </filter>
                                    <path id="spoke" d="M 0 -28 C 10 -48, 10 -68, 0 -83 C -10 -68, -10 -48, 0 -28 Z" 
                                          fill="url(#spokeGradient)" 
                                          stroke="#111827" 
                                          stroke-width="0.8"
                                          filter="url(#deepShadow)"/>
                                    <circle id="bolt" cx="18" cy="0" r="4" fill="#374151" stroke="#111827" stroke-width="0.6" filter="url(#deepShadow)"/>
                                </defs>
                                <g id="wheel-group">
                                    <circle cx="0" cy="0" r="98" fill="url(#tireGradient)" stroke="#000" stroke-width="2.5" filter="url(#deepShadow)"/>
                                    <circle cx="0" cy="0" r="98" fill="url(#treadPattern)" fill-opacity="0.4"/>
                                    <circle cx="0" cy="0" r="90" fill="url(#rimMainGradient)" stroke="#0e7490" stroke-width="1.2" filter="url(#deepShadow)"/>
                                    <circle cx="0" cy="0" r="87" fill="url(#rimDarkGradient)" stroke="none" filter="url(#softInnerShadow)"/>
                                    <circle cx="0" cy="0" r="84" fill="url(#rimMainGradient)" stroke="#0e7490" stroke-width="0.6" filter="url(#softInnerShadow)"/>
                                    <g id="spokes">
                                        <use xlink:href="#spoke" />
                                        <use xlink:href="#spoke" transform="rotate(72)" />
                                        <use xlink:href="#spoke" transform="rotate(144)" />
                                        <use xlink:href="#spoke" transform="rotate(216)" />
                                        <use xlink:href="#spoke" transform="rotate(288)" />
                                    </g>
                                    <circle cx="0" cy="0" r="32" fill="url(#hubGradient)" stroke="#111827" stroke-width="1.8" filter="url(#deepShadow)"/>
                                    <circle cx="0" cy="0" r="28" fill="url(#rimDarkGradient)" stroke="none" filter="url(#softInnerShadow)"/>
                                    <circle cx="0" cy="0" r="18" fill="url(#rimMainGradient)" stroke="#0e7490" stroke-width="0.7"/>
                                    <g id="bolts">
                                        <use xlink:href="#bolt" />
                                        <use xlink:href="#bolt" transform="rotate(72)"/>
                                        <use xlink:href="#bolt" transform="rotate(144)"/>
                                        <use xlink:href="#bolt" transform="rotate(216)"/>
                                        <use xlink:href="#bolt" transform="rotate(288)"/>
                                    </g>
                                    <circle cx="0" cy="0" r="8" fill="#1f2937" stroke="#111827" stroke-width="1"/>
                                    <circle cx="0" cy="0" r="4" fill="#22d3ee" />
                                </g>
                            </svg>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <section id="pricing" class="py-20 bg-gray-800">
            <div class="container mx-auto px-6 text-center">
                <h2 class="text-4xl font-bold mb-12" data-aos="fade-up">Расчет стоимости</h2>
                <div class="max-w-4xl mx-auto" data-aos="zoom-in">
                    <p class="text-xl text-gray-300 mb-8" data-aos="fade-up" data-aos-delay="100">
                        Узнайте точную стоимость услуг для вашего автомобиля. 
                        Воспользуйтесь нашим калькулятором или посмотрите цены на дополнительные услуги ниже.
                    </p>
                    <button id="openPriceCalculator" class="bg-cyan-400 text-gray-900 font-bold py-4 px-10 rounded-lg shadow-xl hover:bg-cyan-300 transition duration-300 transform hover:scale-105 text-xl animate-pulse-glow-btn">
                        <i data-lucide="calculator" class="inline-block -mt-1 mr-2"></i>
                        Открыть калькулятор
                    </button>
                </div>

                <div class="max-w-5xl mx-auto mt-20 grid md:grid-cols-2 gap-12 text-left">
                    <div class="glass-card p-8 rounded-xl shadow-2xl transition-all duration-300 price-glow-card" data-aos="fade-up">
                        <h3 class="text-2xl font-bold text-cyan-400 mb-6">Расходные материалы и Доп. Услуги</h3>
                        <ul class="space-y-4 text-lg">
                            <li class="flex justify-between border-b border-gray-700 py-3 price-list-item"><span>Дошиповка зимних шин</span><span class="font-bold">20 ₽ / шип</span></li>
                            <li class="flex justify-between border-b border-gray-700 py-3 price-list-item"><span>Установка вентиля для б/кам. шин</span><span class="font-bold">60 ₽</span></li>
                            <li class="flex justify-between border-b border-gray-700 py-3 price-list-item"><span>Установка жгута</span><span class="font-bold">260 ₽</span></li>
                            <li class="flex justify-between border-b border-gray-700 py-3 price-list-item"><span>Зачистка диска</span><span class="font-bold">100 ₽</span></li>
                            <li class="flex justify-between border-b border-gray-700 py-3 price-list-item"><span>Обработка диска герметиком</span><span class="font-bold">200 ₽</span></li>
                            <li class="flex justify-between border-b border-gray-700 py-3 price-list-item"><span>Грибок</span><span class="font-bold">200 ₽</span></li>
                            <li class="flex justify-between border-b border-gray-700 py-3 price-list-item"><span>Заплатка (42мм/60мм)</span><span class="font-bold">200 ₽</span></li>
                            <li class="flex justify-between border-b border-gray-700 py-3 price-list-item"><span>Заплатка кордовая (15)</span><span class="font-bold">320 ₽</span></li>
                            <li class="flex justify-between border-b border-gray-700 py-3 price-list-item"><span>Заплатка кордовая (19)</span><span class="font-bold">420 ₽</span></li>
                            <li class="flex justify-between pt-3 price-list-item"><span>Заплатка кордовая (25)</span><span class="font-bold">520 ₽</span></li>
                        </ul>
                    </div>
                    <div class="glass-card p-8 rounded-xl shadow-2xl transition-all duration-300 price-glow-card" data-aos="fade-up" data-aos-delay="200">
                        <h3 class="text-2xl font-bold text-cyan-400 mb-6">Правка и сварка дисков</h3>
                         <ul class="space-y-4 text-lg">
                            <li class="flex justify-between border-b border-gray-700 py-3 price-list-item"><span>Правка диска штамп. (R13-R16)</span><span class="font-bold">420 ₽</span></li>
                            <li class="flex justify-between border-b border-gray-700 py-3 price-list-item"><span>Правка диска литой (R13-R18)</span><span class="font-bold">620 - 1040 ₽</span></li>
                            <li class="flex justify-between pt-3 price-list-item"><span>Сварка диска аргоном (за 1 см.)</span><span class="font-bold">200 ₽</span></li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section id="contact" class="py-20 bg-gray-900">
            <div class="container mx-auto px-6 text-center">
                <h2 class="text-4xl font-bold mb-6" data-aos="fade-up">Не ждите в очереди!</h2>
                <p class="text-2xl text-gray-300 mb-10" data-aos="fade-up" data-aos-delay="100">Выберите удобный способ связи и запишитесь сейчас.</p>
                
                <div class="flex flex-col sm:flex-row justify-center gap-4 max-w-4xl mx-auto" data-aos="fade-up" data-aos-delay="200">
                    <a href="https://wa.me/79027513964" target="_blank" class="bg-green-500 text-white font-bold py-4 px-8 rounded-lg shadow-xl hover:bg-green-400 transition duration-300 transform hover:scale-105 flex items-center justify-center gap-2 text-lg animate-pulse-cta">
                        <i data-lucide="smartphone"></i>
                        Написать в WhatsApp
                    </a>
                    <a href="https://t.me/+79027513964" target="_blank" class="bg-blue-500 text-white font-bold py-4 px-8 rounded-lg shadow-xl hover:bg-blue-400 transition duration-300 transform hover:scale-105 flex items-center justify-center gap-2 text-lg animate-pulse-cta">
                        <i data-lucide="send"></i>
                        Написать в Telegram
                    </a>
                </div>
                
                <div class="mt-8" data-aos="fade-up" data-aos-delay="300">
                    <p class="text-xl text-gray-400">Или просто позвоните:</p>
                    <a href="tel:+79029093879" class="text-4xl font-bold text-cyan-400 hover:text-cyan-300 transition duration-300 mt-2 inline-block">
                        +7 (902) 909-38-79
                    </a>
                </div>
            </div>
        </section>
        
        <section id="map" class="py-20 bg-gray-800">
            <div class="container mx-auto px-6">
                <h2 class="text-4xl font-bold text-center mb-12" data-aos="fade-up">Мы здесь</h2>
                <div class="grid md:grid-cols-2 gap-8 items-start">
                    <div class="rounded-xl overflow-hidden shadow-2xl sticky top-28" data-aos="fade-right">
                         <div style="width: 100%; height: 400px;">
                            <script type="text/javascript" charset="utf-8" async src="https://api-maps.yandex.ru/services/constructor/1.0/js/?um=constructor%3Acc7ed495ed6ddacaeab60edcc7b1c414c118b74ccdccf0d0943bf3296302b918&amp;width=100%25&amp;height=400&amp;lang=ru_RU&amp;scroll=true"></script>
                        </div>
                    </div>
                    <div data-aos="fade-left" data-aos-delay="100">
                        <h3 class="text-3xl font-bold mb-4">Наш адрес:</h3>
                        <p class="text-2xl text-gray-300 mb-6">Тульская Область, Алексинский Район, Село Поповка, Улица Полевая, 2</p>
                        <h3 class="text-3xl font-bold mb-4">Режим работы:</h3>
                        <p class="text-2xl text-gray-300">Ежедневно с 7:00 до 22:30</p>
                        <p class="text-gray-400 mt-4">(ЗВОНИТЬ ПЕРЕД ПОСЕЩЕНИЕМ, есть возможность договориться раньше/позже.)</p>
                        <a href="tel:+79029093879" class="mt-6 inline-block bg-cyan-400 text-gray-900 font-bold py-3 px-6 rounded-lg shadow-md hover:bg-cyan-300 transition duration-300 transform hover:scale-105">
                            <i data-lucide="phone-call" class="inline-block h-5 w-5 -mt-1 mr-2"></i>
                            Уточнить/Позвонить
                        </a>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-gray-900 py-10 border-t border-gray-700" data-aos="fade-up" data-aos-anchor-placement="top-bottom">
        <div class="container mx-auto px-6 text-center text-gray-500">
            <p>&copy; 2025 "ШинаДом". Все права защищены.</p>
            <p class="text-sm mt-2">Сайт: ШинаДом.рф</p>
            <p class="text-sm mt-2">Информациа на сайте не является публичной офертой.</p>
        </div>
    </footer>

    <div id="priceModal" class="fixed inset-0 z-[60] flex items-start sm:items-center justify-center bg-black bg-opacity-70 backdrop-blur-sm p-4 sm:p-6 md:p-8 overflow-y-auto hidden opacity-0 transition-opacity duration-300 ease-in-out">
        <div class="glass-modal w-full max-w-sm md:max-w-3xl rounded-2xl shadow-2xl relative overflow-hidden flex flex-col max-h-[95vh] sm:max-h-[90vh] my-auto" data-aos="zoom-in" data-aos-duration="300">
            
            <div class="flex-shrink-0 p-6 pb-4 md:p-8 md:pb-6 relative">
                <button id="closeModal" class="absolute top-4 right-4 text-gray-400 hover:text-cyan-400 transition-colors z-10">
                    <i data-lucide="x" class="h-8 w-8"></i>
                </button>
                <h3 class="text-2xl md:text-3xl font-bold text-center text-cyan-400">Калькулятор услуг</h3>
            </div>
            
            <div class="flex-grow overflow-y-auto p-6 pt-0 md:p-8 md:pt-0">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
                    
                    <div class="space-y-4">
                        <div>
                            <label for="calc-car-type" class="block text-sm font-bold text-cyan-400 mb-2">1. ВАШ ТРАНСПОРТ</label>
                            <select id="calc-car-type" class="custom-select block w-full bg-gray-700 border border-gray-600 rounded-lg p-3 text-white focus:border-cyan-400 focus:ring-cyan-400 text-lg transition-all">
                                <option value="">-- Выберите тип --</option>
                                <option value="Легковые машины">Легковые машины</option>
                                <option value="Паркетники / Кроссоверы">Паркетники / Кроссоверы</option>
                                <option value="Внедорожники / Джипы">Внедорожники / Джипы</option>
                                <option value="Низкий профиль / RunFlat">Низкий профиль / RunFlat</option>
                                <option value="Газель">Газель</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="calc-tire-size" class="block text-sm font-bold text-cyan-400 mb-2">2. РАЗМЕР КОЛЕС</label>
                            <select id="calc-tire-size" class="custom-select block w-full bg-gray-700 border border-gray-600 rounded-lg p-3 text-white focus:border-cyan-400 focus:ring-cyan-400 text-lg transition-all" disabled>
                                <option value="">-- Сначала выберите тип --</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="calc-wheel-count" class="block text-sm font-bold text-cyan-400 mb-2">3. КОЛИЧЕСТВО КОЛЕС</label>
                            <input type="number" id="calc-wheel-count" value="4" min="1" max="8" class="block w-full bg-gray-700 border border-gray-600 rounded-lg p-3 text-white focus:border-cyan-400 focus:ring-cyan-400 text-lg">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-bold text-cyan-400 mb-2">4. УСЛУГИ</label>
                            <div class="space-y-3">
                                <div id="calc-individual-services" class="space-y-1 p-3 glass-card rounded-lg">
                                    <label for="calc-check-all">
                                        <input id="calc-check-all" type="checkbox" class="h-5 w-5 text-cyan-400 bg-gray-700 border-gray-600 rounded focus:ring-cyan-500">
                                        <span class="service-label-text block text-md font-bold text-white">Выбрать все</span>
                                    </label>
                                    <hr class="border-gray-600 my-2">
                                    <label for="calc-check-snyatie">
                                        <input id="calc-check-snyatie" name="service" type="checkbox" class="h-5 w-5 text-cyan-400 bg-gray-700 border-gray-600 rounded focus:ring-cyan-500" checked>
                                        <span class="service-label-text block text-md text-gray-300">Снятие/Установка</span>
                                    </label>
                                    <label for="calc-check-moyka">
                                        <input id="calc-check-moyka" name="service" type="checkbox" class="h-5 w-5 text-cyan-400 bg-gray-700 border-gray-600 rounded focus:ring-cyan-500">
                                        <span class="service-label-text block text-md text-gray-300">Мойка</span>
                                    </label>
                                    <label for="calc-check-shinomontazh">
                                        <input id="calc-check-shinomontazh" name="service" type="checkbox" class="h-5 w-5 text-cyan-400 bg-gray-700 border-gray-600 rounded focus:ring-cyan-500">
                                        <span class="service-label-text block text-md text-gray-300">Шиномонтаж</span>
                                    </label>
                                    <label for="calc-check-balansirovka">
                                        <input id="calc-check-balansirovka" name="service" type="checkbox" class="h-5 w-5 text-cyan-400 bg-gray-700 border-gray-600 rounded focus:ring-cyan-500">
                                        <span class="service-label-text block text-md text-gray-300">Балансировка</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="glass-card rounded-lg p-6 flex flex-col md:sticky md:top-0">
                        <h4 class="text-2xl font-bold text-white mb-4">Ваш расчет</h4>
                        <div class="space-y-2 text-lg flex-grow">
                            <div class="flex justify-between">
                                <span class="text-gray-400">Транспорт:</span>
                                <span id="summary-car-type" class="font-bold text-right">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Размер:</span>
                                <span id="summary-tire-size" class="font-bold text-right">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Количество:</span>
                                <span id="summary-wheel-count" class="font-bold text-right">0</span>
                            </div>
                            <hr class="border-gray-700">
                            <div>
                                <span class="text-gray-400">Услуги:</span>
                                <ul id="summary-services" class="list-none list-inside font-bold mt-2 text-right">
                                    <li>-</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="text-center mt-6">
                            <p class="text-sm text-gray-400">Итоговая стоимость:</p>
                            <p class="text-5xl md:text-6xl font-black text-cyan-400 my-2">
                                <span id="priceResult">0</span> ₽
                            </p>
                            <p id="priceNote" class="text-base text-red-400 h-6"></p>
                        </div>
                        
                        <div class="pt-4 space-y-3 mt-auto">
                            <p class="text-center text-lg text-gray-300">Свяжитесь с нами для записи:</p>
                            <div class="flex flex-col sm:flex-row justify-center gap-3">
                                <a href="tel:+79029093879" class="w-full sm:w-auto flex-1 bg-cyan-400 text-gray-900 font-bold py-3 px-4 rounded-lg shadow-lg hover:bg-cyan-300 transition duration-300 transform hover:scale-105 flex items-center justify-center gap-2 animate-pulse-cta">
                                    <i data-lucide="phone-call" class="h-5 w-5"></i>
                                    Позвонить
                                </a>
                                <a id="whatsappLink" href="#" target="_blank" class="w-full sm:w-auto flex-1 bg-green-500 text-white font-bold py-3 px-4 rounded-lg shadow-lg hover:bg-green-400 transition-all duration-300 transform hover:scale-105 flex items-center justify-center gap-2 animate-pulse-cta">
                                    <i data-lucide="smartphone" class="h-5 w-5"></i>
                                    WhatsApp
                                </a>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
    
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        const lenis = new Lenis()

        function raf(time) {
          lenis.raf(time)
          requestAnimationFrame(raf)
        }

        requestAnimationFrame(raf)

        document.addEventListener('DOMContentLoaded', () => {
            
            const header = document.querySelector('header.fixed');
            
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    
                    const headerHeight = header ? header.offsetHeight : 0;
                    const href = this.getAttribute('href');
                    let target;

                    if (href === '#') {
                        target = 0;
                    } else {
                        target = document.querySelector(href);
                    }
                    
                    if (target !== null && target !== undefined) {
                        lenis.scrollTo(target, {
                            offset: href === '#' ? 0 : -headerHeight,
                            duration: 1.2,
                            easing: (t) => (t === 1 ? 1 : 1 - Math.pow(2, -10 * t))
                        });
                    }
                });
            });

            const progressBar = document.getElementById('scroll-progress-bar');
            
            const wheel = document.getElementById('wheel');
            const wheelGroup = document.getElementById('wheel-group');
            const wheelContainer = document.getElementById('why-us-container');
            let wheelElementsFound = wheel && wheelContainer && wheelGroup;
            
            let startScale, startRotateX, startRotateZInitial, endScale, endRotateX, lerp;
            let containerTop = 0;
            let containerHeight = 0;
            let viewportHeight = 0;
            let animStart = 0;
            let animDuration = 0;
            
            if (wheelElementsFound) {
                startScale = 0.05;
                startRotateX = 70;
                startRotateZInitial = -720; 
                endScale = 1;
                endRotateX = 0;
                
                wheel.style.opacity = 0;
                wheel.style.transform = `scale(${startScale}) rotateX(${startRotateX}deg) rotateZ(${startRotateZInitial}deg)`;
                wheel.style.transformOrigin = 'center center';
                wheel.style.willChange = 'transform, opacity';
                
                lerp = (a, b, t) => a + (b - a) * t;
                
                const containerRect = wheelContainer.getBoundingClientRect();
                containerTop = containerRect.top + window.scrollY; 
                containerHeight = wheelContainer.offsetHeight;
                viewportHeight = window.innerHeight;
                animStart = containerTop;
                animDuration = containerHeight - viewportHeight;
            }
            
            const easeOutQuad = (t) => t * (2 - t);
            
            let hasWheelRolledAway = false;

            lenis.on('scroll', (e) => {
                const scrollTop = e.animatedScroll;
                const docHeight = document.documentElement.scrollHeight;
                const clientHeight = document.documentElement.clientHeight;
                
                let scrollPercent = 0;
                if ((docHeight - clientHeight) > 0) {
                    scrollPercent = (scrollTop / (docHeight - clientHeight));
                }
                if (progressBar) {
                    progressBar.style.width = (scrollPercent * 100) + '%';
                }

                if (wheelElementsFound) {
                    
                    let animProgress = 0;
                    if (scrollTop >= animStart) {
                        animProgress = (scrollTop - animStart) / animDuration;
                    } else {
                        animProgress = 0;
                    }
                    
                    if (scrollTop < animStart && hasWheelRolledAway) {
                        hasWheelRolledAway = false;
                        wheelGroup.classList.remove('spinning-group');
                        wheel.style.transition = 'none'; 
                        wheel.style.opacity = 0;
                        wheel.style.transform = `scale(${startScale}) rotateX(${startRotateX}deg) rotateZ(${startRotateZInitial}deg)`;
                    }

                    if (hasWheelRolledAway) {
                        return;
                    }

                    if (animProgress <= 1.0) {
                        const buildUpProgress = Math.max(0, Math.min(1, animProgress));
                        
                        const currentOpacity = buildUpProgress;
                        const currentScale = lerp(startScale, endScale, buildUpProgress);
                        const currentRotateX = lerp(startRotateX, endRotateX, buildUpProgress);
                        const combinedRotateZ = lerp(startRotateZInitial, 0, buildUpProgress);

                        wheel.style.transition = 'none';
                        wheel.style.opacity = currentOpacity;
                        wheel.style.transform = `scale(${currentScale}) rotateX(${currentRotateX}deg) rotateZ(${combinedRotateZ}deg) translateX(0px)`;
                        
                        wheelGroup.classList.remove('spinning-group');

                    } else if (animProgress > 1.0 && !hasWheelRolledAway) {
                        hasWheelRolledAway = true; 
                        
                        wheel.style.transition = 'none';
                        wheel.style.opacity = 1; 
                        wheel.style.transform = 'scale(1) rotateX(0deg) rotateZ(0deg) translateX(0px)';
                        
                        wheelGroup.classList.add('spinning-group');
                        
                        setTimeout(() => {
                            wheel.style.transition = 'transform 2.0s cubic-bezier(0.5, 0, 0.8, 0.5)'; 
                            wheel.style.transform = 'scale(1) rotateX(0deg) rotateZ(0deg) translateX(150vw)'; 
                        }, 0); 
                    }
                }
            });

            const priceData = {
                "Легковые машины": {
                    "R14": { "shinomontazh": 100, "balansirovka": 240, "snyatie": 160, "moyka": 80, "complex": 2380 },
                    "R15": { "shinomontazh": 100, "balansirovka": 260, "snyatie": 180, "moyka": 100, "complex": 2520 },
                    "R16": { "shinomontazh": 120, "balansirovka": 280, "snyatie": 200, "moyka": 100, "complex": 2780 },
                    "R17": { "shinomontazh": 140, "balansirovka": 320, "snyatie": 220, "moyka": 120, "complex": 3100 },
                    "R18": { "shinomontazh": 140, "balansirovka": 320, "snyatie": 220, "moyka": 120, "complex": 3200 },
                    "R19": { "shinomontazh": 160, "balansirovka": 360, "snyatie": 240, "moyka": 140, "complex": 3620 },
                    "R20": { "shinomontazh": 180, "balansirovka": 400, "snyatie": 280, "moyka": 160, "complex": 4080 }
                },
                "Внедорожники / Джипы": {
                    "R15": { "shinomontazh": 120, "balansirovka": 280, "snyatie": 200, "moyka": 100, "complex": 2840 },
                    "R16": { "shinomontazh": 120, "balansirovka": 280, "snyatie": 200, "moyka": 100, "complex": 2840 },
                    "R17": { "shinomontazh": 140, "balansirovka": 320, "snyatie": 220, "moyka": 120, "complex": 3240 },
                    "R18": { "shinomontazh": 160, "balansirovka": 340, "snyatie": 240, "moyka": 140, "complex": 3480 },
                    "R19": { "shinomontazh": 180, "balansirovka": 380, "snyatie": 260, "moyka": 140, "complex": 3880 },
                    "R20": { "shinomontazh": 180, "balansirovka": 420, "snyatie": 280, "moyka": 160, "complex": 4120 },
                    "R21": { "shinomontazh": 200, "balansirovka": 440, "snyatie": 300, "moyka": 160, "complex": 4420 },
                    "R22": { "shinomontazh": 200, "balansirovka": 460, "snyatie": 320, "moyka": 180, "complex": 4660 }
                },
                "Паркетники / Кроссоверы": {
                    "R15": { "shinomontazh": 140, "balansirovka": 300, "snyatie": 200, "moyka": 100, "complex": 2960 },
                    "R16": { "shinomontazh": 140, "balansirovka": 300, "snyatie": 200, "moyka": 100, "complex": 2960 },
                    "R17": { "shinomontazh": 140, "balansirovka": 320, "snyatie": 220, "moyka": 120, "complex": 3240 },
                    "R18": { "shinomontazh": 160, "balansirovka": 360, "snyatie": 240, "moyka": 140, "complex": 3520 },
                    "R19": { "shinomontazh": 160, "balansirovka": 380, "snyatie": 260, "moyka": 140, "complex": 3820 },
                    "R20": { "shinomontazh": 180, "balansirovka": 400, "snyatie": 280, "moyka": 160, "complex": 4080 },
                    "R21": { "shinomontazh": 200, "balansirovka": 440, "snyatie": 300, "moyka": 160, "complex": 4360 }
                },
                "Низкий профиль / RunFlat": {
                    "R16": { "shinomontazh": 160, "balansirovka": 360, "snyatie": 240, "moyka": 140, "complex": 3600 },
                    "R17": { "shinomontazh": 180, "balansirovka": 380, "snyatie": 260, "moyka": 140, "complex": 3900 },
                    "R18": { "shinomontazh": 180, "balansirovka": 420, "snyatie": 280, "moyka": 160, "complex": 4140 },
                    "R19": { "shinomontazh": 200, "balansirovka": 460, "snyatie": 300, "moyka": 180, "complex": 4580 },
                    "R20": { "shinomontazh": 220, "balansirovka": 520, "snyatie": 340, "moyka": 200, "complex": 5120 }
                },
                "Газель": {
                    "R16": { "shinomontazh": 280, "balansirovka": 280, "snyatie": 220, "moyka": 320, "complex": 4320 }
                }
            };
            
            const serviceLabels = {
                moyka: 'Мойка',
                shinomontazh: 'Шиномонтаж',
                balansirovka: 'Балансировка',
                snyatie: 'Снятие/Установка'
            };

            let quizState = {
                carType: null,
                tireSize: null,
                wheelCount: 4,
                services: ['snyatie']
            };

            const modal = document.getElementById('priceModal');
            const openBtn = document.getElementById('openPriceCalculator');
            const closeBtn = document.getElementById('closeModal');

            const carTypeSelect = document.getElementById('calc-car-type');
            const tireSizeSelect = document.getElementById('calc-tire-size');
            const wheelCountInput = document.getElementById('calc-wheel-count');
            
            const checkAllServices = document.getElementById('calc-check-all');
            const serviceChecks = {
                moyka: document.getElementById('calc-check-moyka'),
                shinomontazh: document.getElementById('calc-check-shinomontazh'),
                balansirovka: document.getElementById('calc-check-balansirovka'),
                snyatie: document.getElementById('calc-check-snyatie')
            };
            
            const summary = {
                carType: document.getElementById('summary-car-type'),
                tireSize: document.getElementById('summary-tire-size'),
                wheelCount: document.getElementById('summary-wheel-count'),
                services: document.getElementById('summary-services'),
            };

            const priceResultEl = document.getElementById('priceResult');
            const priceNoteEl = document.getElementById('priceNote');
            const whatsappLink = document.getElementById('whatsappLink');

            function resetQuiz() {
                quizState = { carType: null, tireSize: null, wheelCount: 4, services: ['snyatie'] };
                carTypeSelect.value = "";
                tireSizeSelect.innerHTML = '<option value="">-- Сначала выберите тип --</option>';
                tireSizeSelect.disabled = true;
                wheelCountInput.value = 4;
                
                Object.values(serviceChecks).forEach(check => {
                    check.checked = false;
                });
                serviceChecks.snyatie.checked = true;
                checkAllServices.checked = false;
                
                updateSummary();
                calculatePrice();
            }

            openBtn.addEventListener('click', () => {
                resetQuiz();
                modal.classList.remove('hidden');
                setTimeout(() => modal.classList.remove('opacity-0'), 10);
            });
            
            function closeModal() {
                 modal.classList.add('opacity-0');
                setTimeout(() => modal.classList.add('hidden'), 300);
            }
            
            closeBtn.addEventListener('click', closeModal);
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal();
                }
            });

            carTypeSelect.addEventListener('change', () => {
                quizState.carType = carTypeSelect.value;
                updateTireSizes();
                updateSummary();
                calculatePrice();
            });

            function updateTireSizes() {
                tireSizeSelect.innerHTML = '';
                if (quizState.carType && priceData[quizState.carType]) {
                    const sizes = Object.keys(priceData[quizState.carType]);
                    
                    if (sizes.length > 1) {
                         tireSizeSelect.innerHTML = '<option value="">-- Выберите размер --</option>';
                    }
                    
                    sizes.forEach(size => {
                        const option = document.createElement('option');
                        option.value = size;
                        option.textContent = size;
                        tireSizeSelect.appendChild(option);
                    });
                    
                    tireSizeSelect.disabled = false;
                    tireSizeSelect.classList.remove('input-error');
                    
                    if (quizState.carType === 'Газель' && sizes.length === 1) {
                        tireSizeSelect.value = sizes[0];
                        tireSizeSelect.disabled = true;
                    } else if (sizes.length === 1) {
                         tireSizeSelect.value = sizes[0];
                    } else {
                        tireSizeSelect.value = "";
                    }
                    
                    quizState.tireSize = tireSizeSelect.value;
                    
                } else {
                    tireSizeSelect.innerHTML = '<option value="">-- Сначала выберите тип --</option>';
                    tireSizeSelect.disabled = true;
                    quizState.tireSize = null;
                }
            }

            tireSizeSelect.addEventListener('change', () => {
                quizState.tireSize = tireSizeSelect.value;
                updateSummary();
                calculatePrice();
            });
            
            wheelCountInput.addEventListener('change', () => {
                let count = parseInt(wheelCountInput.value);
                if (isNaN(count) || count < 1) {
                    count = 1;
                    wheelCountInput.value = 1;
                }
                quizState.wheelCount = count;
                updateSummary();
                calculatePrice();
            });

            checkAllServices.addEventListener('click', () => {
                const isChecked = checkAllServices.checked;
                Object.values(serviceChecks).forEach(check => {
                    check.checked = isChecked;
                });
                updateServicesFromCheckboxes();
            });

            Object.values(serviceChecks).forEach(check => {
                check.addEventListener('click', () => {
                    if (!check.checked) {
                        checkAllServices.checked = false;
                    } else {
                        const allChecked = Object.values(serviceChecks).every(c => c.checked);
                        if (allChecked) {
                            checkAllServices.checked = true;
                        }
                    }
                    updateServicesFromCheckboxes();
                });
            });
            
            function updateServicesFromCheckboxes() {
                quizState.services = [];
                if(serviceChecks.moyka.checked) quizState.services.push('moyka');
                if(serviceChecks.shinomontazh.checked) quizState.services.push('shinomontazh');
                if(serviceChecks.balansirovka.checked) quizState.services.push('balansirovka');
                if(serviceChecks.snyatie.checked) quizState.services.push('snyatie');
                updateSummary();
                calculatePrice();
            }
            
            function updateSummary() {
                summary.carType.textContent = quizState.carType || '-';
                summary.tireSize.textContent = quizState.tireSize || '-';
                summary.wheelCount.textContent = quizState.wheelCount || 0;
                
                summary.services.innerHTML = '';
                if (quizState.services.length > 0) {
                    quizState.services.forEach(serviceKey => {
                        const li = document.createElement('li');
                        li.textContent = serviceLabels[serviceKey] || serviceKey;
                        summary.services.appendChild(li);
                    });
                } else {
                     const li = document.createElement('li');
                    li.textContent = '-';
                    summary.services.appendChild(li);
                }
            }

            function animateValue(obj, start, end, duration) {
                let startTimestamp = null;
                const step = (timestamp) => {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    obj.innerHTML = Math.floor(progress * (end - start) + start).toLocaleString('ru-RU');
                    if (progress < 1) {
                        window.requestAnimationFrame(step);
                    } else {
                        obj.classList.remove('animate-pop');
                        void obj.offsetWidth; 
                        obj.classList.add('animate-pop');
                    }
                };
                window.requestAnimationFrame(step);
            }
            
            function updateWhatsAppLink(totalPrice) {
                const { carType, tireSize, wheelCount, services } = quizState;
                
                let text = '';
                const defaultText = 'Здравствуйте! Пишу по поводу Шиномонтажа "ШинаДом"\nСейчас распишу детали...';

                if (carType && tireSize) {
                    const selectedServicesText = services.length > 0
                        ? services.map(key => `  - ${serviceLabels[key]}`).join('\n')
                        : '  - (услуги не выбраны)';
                    
                    text = `Здравствуйте!
Хочу записаться на шиномонтаж.

Детали расчета:
- Тип машины: ${carType}
- Размер колес: ${tireSize}
- Количество: ${wheelCount}
- Выбранные услуги:
${selectedServicesText}

- Общая цена: ${totalPrice} ₽
`;
                } else {
                    text = defaultText;
                }

                whatsappLink.classList.remove('btn-disabled');
                const encodedText = encodeURIComponent(text);
                whatsappLink.href = `https://wa.me/79027513964?text=${encodedText}`;
            }

            const calculatePrice = () => {
                const { carType, tireSize, wheelCount, services } = quizState;
                
                carTypeSelect.classList.remove('input-error');
                tireSizeSelect.classList.remove('input-error');

                if (!carType) {
                    animateValue(priceResultEl, parseInt(priceResultEl.textContent.replace(/ /g, '')) || 0, 0, 200);
                    priceNoteEl.textContent = 'Выберите тип транспорта';
                    carTypeSelect.classList.add('input-error');
                    updateWhatsAppLink(0);
                    return;
                }
                
                if (!tireSize) {
                    animateValue(priceResultEl, parseInt(priceResultEl.textContent.replace(/ /g, '')) || 0, 0, 200);
                    priceNoteEl.textContent = 'Выберите размер колес';
                    tireSizeSelect.classList.add('input-error');
                    updateWhatsAppLink(0);
                    return;
                }
                
                const prices = priceData[carType][tireSize];
                if (!prices) {
                    animateValue(priceResultEl, parseInt(priceResultEl.textContent.replace(/ /g, '')) || 0, 0, 200);
                    priceNoteEl.textContent = 'Данные не найдены';
                    updateWhatsAppLink(0);
                    return;
                }

                let totalPrice = 0;
                
                if (services.includes('shinomontazh')) totalPrice += (prices.shinomontazh || 0) * wheelCount;
                if (services.includes('balansirovka')) totalPrice += (prices.balansirovka || 0) * wheelCount;
                if (services.includes('snyatie')) totalPrice += (prices.snyatie || 0) * wheelCount;
                if (services.includes('moyka')) totalPrice += (prices.moyka || 0) * wheelCount;
                
                if (services.length > 0) {
                    priceNoteEl.textContent = `Цена за ${wheelCount} колес(а)`;
                } else {
                     priceNoteEl.textContent = ``;
                }
                
                if(wheelCount === 0 || services.length === 0) {
                    totalPrice = 0;
                    priceNoteEl.textContent = 'Выберите услуги';
                }
                
                animateValue(priceResultEl, parseInt(priceResultEl.textContent.replace(/ /g, '')) || 0, totalPrice, 300);
                updateWhatsAppLink(totalPrice);
            };
            
        });
        
        AOS.init({
            duration: 800,
            once: true,
            offset: 50,
        });
        lucide.createIcons();
    </script>
</body>
</html>
